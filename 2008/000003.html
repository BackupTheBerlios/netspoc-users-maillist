<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Netspoc-users] All/any with netspoc? How to grant access to	public web server
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/netspoc-users/2008/index.html" >
   <LINK REL="made" HREF="mailto:netspoc-users%40lists.berlios.de?Subject=Re%3A%20%5BNetspoc-users%5D%20All/any%20with%20netspoc%3F%20How%20to%20grant%20access%20to%0A%09public%20web%20server&In-Reply-To=%3C48D7F4BB.8080109%40gmx.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000002.html">
   <LINK REL="Next"  HREF="000004.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Netspoc-users] All/any with netspoc? How to grant access to	public web server</H1>
    <B>Heinz Knutzen</B> 
    <A HREF="mailto:netspoc-users%40lists.berlios.de?Subject=Re%3A%20%5BNetspoc-users%5D%20All/any%20with%20netspoc%3F%20How%20to%20grant%20access%20to%0A%09public%20web%20server&In-Reply-To=%3C48D7F4BB.8080109%40gmx.de%3E"
       TITLE="[Netspoc-users] All/any with netspoc? How to grant access to	public web server">heinz.knutzen at gmx.de
       </A><BR>
    <I>Mon Sep 22 21:40:43 CEST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="000002.html">[Netspoc-users] All/any with netspoc? How to grant access to	publicweb server
</A></li>
        <LI>Next message: <A HREF="000004.html">[Netspoc-users] All/any with netspoc? How to grant access to	public web server
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3">[ date ]</a>
              <a href="thread.html#3">[ thread ]</a>
              <a href="subject.html#3">[ subject ]</a>
              <a href="author.html#3">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>In my last proposal we had to add a line &quot;subnet_of = network:internet;&quot; 
to each network definition.
This was tedious.

Below you will find another configuration which uses an 'any' object to 
represent access from the internet. With this solution we avoid to 
define a network 0.0.0.0/0. Hence we have no problem with unwanted 
subnet relations.

This configuration wont generate a static route for 0.0.0.0/0 because it 
doesn't know about this network. Routing for interface:myrouter.isp-me 
has been disabled by &quot;routing = manual;&quot;.

------------------ input -------------------
any:internet = { link = network:isp; }

network:isp = {
    ip = 1.1.1.0/24;
}

router:isp0 = {
    interface:isp;
    interface:isp-me = {
        ip = 2.2.3.1;
    }
}

network:isp-me = {
    ip = 2.2.3.0/30;
}

router:myrouter = {
    managed = full;
    model = IOS;
    interface:isp-me= {
        ip = 2.2.3.2;
        routing = manual;
        hardware = i1;
    }
    interface:public = {
        ip = 2.2.2.1;
        hardware = i0;
    }
}

network:public = {
    ip = 2.2.2.0/24;
    host:www = { ip = 2.2.2.10; }
}

service:http = tcp 80;

policy:pubwww = {
    description = how to allow all?
    user = any:internet;
    permit src = user;
        dst = host:www;
        srv = service:http;
}

-------------------- Output ------------------------

# ./netspoc martin code
Network Security Policy Compiler, version 2.281
Read 2 routers, 3 networks, 1 hosts
Read 1 services, 0 service groups
Read 0 groups, 1 policies
Arranging services
Linking topology
Distributing NAT
Finding subnets
Preparing security domains and areas
Preparing fast path traversal
Converting hosts to subnets
Expanding policies
Preparing crypto tunnels and expanding crypto rules
Optimizing globally
Checking rules with 'any' objects
Finding routes and statics
Checking for duplicate routes
Generating reverse rules for stateless routers
Marking rules for secondary optimization
Optimizing globally
Distributing rules
Optimizing locally
Printing code

# cat code/myrouter
! Generated by Network Security Policy Compiler, version 2.281

! [ BEGIN router:myrouter ]
! [ Model = IOS ]
! [ Routing ]
! [ ACL ]
ip access-list extended i1_in
 deny ip any  host 2.2.3.2
 deny ip any  host 2.2.2.1
 permit tcp any  host 2.2.2.10 eq 80
 deny ip any  any
interface i1
 ip access-group i1_in in

ip access-list extended i0_in
 deny ip any  host 2.2.3.2
 deny ip any  host 2.2.2.1
 permit tcp host 2.2.2.10  any  established
 deny ip any  any
interface i0
 ip access-group i0_in in

! [ END router:myrouter ]



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000002.html">[Netspoc-users] All/any with netspoc? How to grant access to	publicweb server
</A></li>
	<LI>Next message: <A HREF="000004.html">[Netspoc-users] All/any with netspoc? How to grant access to	public web server
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3">[ date ]</a>
              <a href="thread.html#3">[ thread ]</a>
              <a href="subject.html#3">[ subject ]</a>
              <a href="author.html#3">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/netspoc-users">More information about the Netspoc-users
mailing list</a><br>
</body></html>
